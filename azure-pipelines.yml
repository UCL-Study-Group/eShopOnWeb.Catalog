trigger:
  - main

pool:
  name: 'Self Hosted'

resources:
  - repo: self

variables:
  tag: '$(Build.BuildId)'
  projectName: $[lower(replace(variables['Build.Repository.Name'], '.', '-'))]

steps:
  - task: DockerCompose@0
    displayName: Build services
    inputs:
      action: 'Build services'
      dockerComposeFile: 'docker-compose.yml'
      projectName: '$(projectName)'
      qualifyImageNames: true
      additionalImageTags: '$(tag)'